<!doctype html>
<title>Available Slides</title>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script>
			function liveSearch(value){
				value = value.trim(); // remove any spaces around the text
				if(value != ""){ // don't make requests with an empty string
					$.ajax({
						url: "search",
						data: {searchText: value},
						dataType: "json",
						success: function(data){
						$("#slideTable > tbody").html("");
                        $.each(data, function(index, element) {
                                    for (i = 0; i < element.length; i++) {
                                        $("#slideTable tbody").append(
                                              "<tr>" +
                                                    "<td><b><a href='"+element[i]["filename"]+"'>"+element[i]["filename"]+"</a></b></td>" +
                                                    "<td>"+element[i]["number"]+"</td>" +
                                                    "<td>"+element[i]["genus"]+"</td>" +
                                                    "<td>"+element[i]["species"]+"</td>" +
                                                    "<td>"+element[i]["stain"]+"</td>" +
                                                    "<td>"+element[i]["source"]+"</td>" +
                                                    "<td>"+element[i]["contributor"]+"</td>" +
                                                    "<td>"+element[i]["processing"]+"</td>" +
                                                    "<td>"+element[i]["comments"]+"</td>" +
                                                    "<td>"+element[i]["date_sent_to_aperio"]+"</td>" +
                                                    "<td>"+element[i]["infect"]+"</td>" +
                                                    "<td>"+element[i]["collection_site"]+"</td>" +
                                                    "<td>"+element[i]["histopath_description"]+"</td>" +
                                                    "<td>"+element[i]["attachment"]+"</td>" +
                                              "</tr>"
                                        );

                                    }
                                });
						}

					});
				}
				else{
					$("#results").html(""); // set the results empty in case of empty string
				}
			}
		</script>
</head>
<style type="text/css">
li {
    list-style-type: none;
    margin: 0.4em 0;
}
li.none {
    font-style: italic;
}
.table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
  background-color: #addeb2;
}
</style>
    <input type="text" onkeyup="liveSearch(this.value)"> <!-- Assigns the key up event to call the liveSearch() function -->
    <br>
    <div id="results"></div> <!-- Results will be printed here -->
    <table border="1px" id="slideTable" class="table table-striped table-hover">
        <thead>
        <tr >
            <th scope="col">Slide Filename</th>
            <th scope="col">Slide Number</th>
            <th scope="col">Genus</th>
            <th scope="col">Species</th>
            <th scope="col">Stain</th>
            <th scope="col">Source</th>
            <th scope="col">Contributor</th>
            <th scope="col">Processing</th>
            <th scope="col">Comments</th>
            <th scope="col">Date Sent to Aperio</th>
            <th scope="col">Infect/Non</th>
            <th scope="col">Collection Site</th>
            <th scope="col">Histopathologic Description</th>
            <th scope="col">Attachment</th>

        </tr>
        </thead>
    {% for entry in root_dir.children recursive %}
            <tr>
                <th scope="row">
            {% if entry.url_path %}
                <a href="{{ url_for('slide', path=entry.url_path) }}">
                    {{ entry.name }}
                </a>
                <td>{{ entry.slide_number }} </td>
                <td>{{ entry.genus }} </td>
                <td>{{ entry.species }} </td>
                <td>{{ entry.stain }} </td>
                <td>{{ entry.source }} </td>
                <td>{{ entry.contributor }} </td>
                <td>{{ entry.processing }} </td>
                <td>{{ entry.comments }} </td>
                <td>{{ entry.date_sent_to_aperio }} </td>
                <td>{{ entry.infect }} </td>
                <td>{{ entry.collection_site }} </td>
                <td>{{ entry.histopath_description }} </td>
                <td>{{ entry.attachment }} </td>
            {% else %}
                {{ entry.name }}
            {% endif %}

            {% if entry.children %}
                <ul>
                    {{ loop(entry.children) }}
                </ul>
            {% endif %}
                </th>

            </tr>
    {% else %}
        <li class="none">None</li>
    {% endfor %}
    </table>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
